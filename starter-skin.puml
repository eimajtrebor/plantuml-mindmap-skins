@startuml "starter-skin"

!define DEFAULT_FONT_SIZE 12
!define DEFAULT_FONT_SCALE 2
!define DEFAULT_LINE_THICKNESS 1
!define DEFAULT_LINE_COLOR #333333
!define DEFAULT_SHADOWING 1
!define DEFAULT_MARGIN 25
!define DEFAULT_MARGIN 10
!define DEFAULT_BGCOLOR LightYellow
!define DEFAULT_FGCOLOR Black

!if (%not(%variable_exists("$BGCOLOR_DEFAULT")))
    !$BGCOLOR_DEFAULT = DEFAULT_BGCOLOR
!endif

!if (%not(%variable_exists("$FGCOLOR_DEFAULT")))
    !$FGCOLOR_DEFAULT = DEFAULT_FGCOLOR
!endif

!DEFAULT_THEME = {
    "levels": [
        { "fg": "$FGCOLOR_DEFAULT", "bg": "$BGCOLOR_DEFAULT" },
        { "fg": "$FGCOLOR_DEFAULT", "bg": "$BGCOLOR_DEFAULT" },
        { "fg": "$FGCOLOR_DEFAULT", "bg": "$BGCOLOR_DEFAULT" },
        { "fg": "$FGCOLOR_DEFAULT", "bg": "$BGCOLOR_DEFAULT" },
        { "fg": "$FGCOLOR_DEFAULT", "bg": "$BGCOLOR_DEFAULT" },
        { "fg": "$FGCOLOR_DEFAULT", "bg": "$BGCOLOR_DEFAULT" },
        { "fg": "$FGCOLOR_DEFAULT", "bg": "$BGCOLOR_DEFAULT" },
        { "fg": "$FGCOLOR_DEFAULT", "bg": "$BGCOLOR_DEFAULT" }
    ]
}

!if (%not(%variable_exists("$THEME")))
    !$THEME = DEFAULT_THEME
!endif

!function $get_levels()
    !$count = 0
    !foreach $level in $THEME.levels
        !$count = $count + 1
    !endfor
    !return $count
!endfunction

!$LEVELS = $get_levels()

!if (%not(%variable_exists("$FONT_SIZE")))
    !$FONT_SIZE = DEFAULT_FONT_SIZE
!endif

!if (%not(%variable_exists("$FONT_SCALE")))
    !$FONT_SCALE = DEFAULT_FONT_SCALE
!endif

!if (%not(%variable_exists("$BGCOLOR_ROOT")))
    !$BGCOLOR_ROOT = $THEME.levels[0].bg
!endif

!if (%not(%variable_exists("$FGCOLOR_ROOT")))
    !$FGCOLOR_ROOT = $THEME.levels[0].fg
!endif

!if (%not(%variable_exists("$LINE_THICKNESS")))
    !$LINE_THICKNESS = DEFAULT_LINE_THICKNESS
!endif

!if (%not(%variable_exists("$LINE_COLOR")))
    !$LINE_COLOR = DEFAULT_LINE_COLOR
!endif

!if (%not(%variable_exists("$SHADOWING")))
    !$SHADOWING = DEFAULT_SHADOWING
!endif

!if (%not(%variable_exists("$MARGIN")))
    !$MARGIN = DEFAULT_MARGIN
!endif

!if (%not(%variable_exists("$PADDING")))
    !$PADDING = DEFAULT_PADDING
!endif

!procedure $arrow_style()
    LineThickness $LINE_THICKNESS
    LineColor $LINE_COLOR
!endprocedure

!procedure $root_style()
    BackgroundColor $BGCOLOR_ROOT
    FontColor $FGCOLOR_ROOT
    FontSize $calc_font(0)
!endprocedure

!procedure $depth_styles()
    !$index = 0
    !foreach $level in $THEME.levels
    !if ($index > 0)
    :depth($index) {
        BackgroundColor $level.bg
        FontColor $level.fg
        FontSize $calc_font($index)
    }
    !endif
    !$index = $index + 1
    !endfor
!endprocedure

!function $calc_font($level)
    !$scale = %intval($FONT_SCALE)
    !$factor = %intval($LEVELS) - %intval($level)
    !$adjustment = $factor * $scale
    !return %intval($FONT_SIZE) + $adjustment
!endfunction

<style>
mindmapDiagram {
    node {
        Shadowing $SHADOWING
        Margin $MARGIN
        Padding $PADDING
    }
    rootNode {
        $root_style()
    }
    $depth_styles()
    arrow {
        $arrow_style()
    }
}
</style>
@enduml
